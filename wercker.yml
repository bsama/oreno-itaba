box: wercker-labs/docker
build:
  steps:
    - install-packages:
        packages: |
          ruby
          ruby-dev
    - script:
        name: run bundle install
        code: |
          gem install bundler --no-ri --no-rdoc -V
          bundle install
    - script:
        name: run kitchen init
        code: |
          kitchen init --driver=kitchen-docker --provisioner=itamae
    - script:
        name: run kitchen test
        code: |
          kitchen test
    - script:
        name: run kitchen verify
        code: |
          kitchen verify

  after-steps:
    - sherzberg/slack-notify:
        subdomain: $SLACK_TEAM
        token: $SLACK_TOKEN
        channel: $SLACK_CHANNEL
        username: wercker
        icon_url: https://avatars3.githubusercontent.com/u/1695193?s=140
